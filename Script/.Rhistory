add_osm_feature(key = "leisure", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
PolPoblado_buf <- st_buffer(Poblado,dist=0.001) #Debido a que se detectaron apartamentos fuera del polígono de El Poblado, se realiza el buffer para aumentar dicho Polígono y así incluirlos
#Parques
parkant = opq(bbox = st_bbox(mnzMedellin)) %>%
add_osm_feature(key = "leisure", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
#Parques
Poblado_buf <- st_buffer(Poblado,dist=0.001)
mnz_pob <- mnzMedellin[PolPoblado_buf,]
mnz_pob <- mnzMedellin[Poblado_buf,]
parkant = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "leisure", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
parkant %>% head()
barant = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "amenity", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
parkant = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "leisure", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzMedellin) %>% # manzanas
addPolygons(data= Poblado , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addPolygons(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
class(Transporte_publicoMed)
class(mnz_pob)
class(barant)
cajaElpob <- opq(bbox = getbb("Comuna 14 - El Poblado Medellín"))
##Mapa Medellín
rm(Poblado)
##Mapa Medellín
Poblado = getbb(place_name = "Comuna 14 - El Poblado Medellin",
featuretype = "amenity",
format_out = "sf_polygon")
rm(cajaElpob)
rm(Poblado_buf)
rm(mnz_pob)
cajaElpob <- opq(bbox = getbb("Comuna 14 - El Poblado Medellín"))
Poblado_buf <- st_buffer(Poblado,dist=0.001)
mnz_pob <- mnzMedellin[Poblado_buf,]
## objeto osm para extracción de amenity Transporte público
rm(osmmed)
## objeto osm para extracción de amenity Transporte público
rm(osmmed_sf)
## objeto osm para extracción de amenity Transporte público
osmmed = opq(bbox = getbb("Medellin")) %>%
add_osm_feature(key="amenity" , value="bus_station")
class(osmmed)
osmmed_sf = osmmed %>% osmdata_sf()
Transporte_publicoMed = osmmed_sf$osm_points %>% select(osm_id,amenity)
class(Transporte_publicoMed)
#Extracción Datos Bares
barant = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "amenity", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
#Extracción Datos Bares
rm(barant)
#Extracción Datos Bares
barant = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "amenity", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addPolygons(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addPolygons(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
View(Transporte_publicoMed)
TPM = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "amenity", value = "bus_station") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,geometry)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addPolygons(data= TPM , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addPolygons(data= osmmed_sf , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2) %>%
addCircles(data = parkmed, col= "purple", weight = 2)
#Parques
parkmed = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "leisure", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
#Parques
parkmed = opq(bbox = st_bbox(mnz_pob)) %>%
add_osm_feature(key = "leisure", value = "park") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
#Parques
parkmed = opq(bbox = st_bbox(mnzAnt)) %>%
add_osm_feature(key = "leisure", value = "park") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
parkmed %>% head()
leaflet() %>% addTiles() %>%
addPolygons(data=mnzAnt) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="green") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2) %>%
addCircles(data = parkmed, col= "purple", weight = 2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob, color ="#E76F51" ) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="purple") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2) %>%
addCircles(data = parkmed, col= "green", weight = 2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob, color ="#pink" ) %>% # manzanas
addCircles(data= Transporte_publicoMed , col="purple") %>%  # transportepub
addCircles(data= HOUSEMED , col="red", weight=2) %>% # apartamentos
addCircles(data=barant , col="black" , weight=2) %>%
addCircles(data = parkmed, col= "green", weight = 2)
##Mapa Medellín
Polchapinero <- getbb(place_name = "UPZ Chapinero, Bogota",
featuretype = "boundary:administrative",
format_out = "sf_polygon") %>% .$multipolygon
leaflet() %>% addTiles() %>% addPolygons(data= Polchapinero, col = "darkblue")%>% addCircleMarkers(data=HOUSEMED, col= "red")
leaflet() %>% addTiles() %>% addPolygons(data= Polchapinero, col = "darkblue")%>% addCircleMarkers(data=HOUSEBOG, col= "red")
cajaChap <- opq(bbox = getbb("Chapinero Bogotá"))
mnzB<-readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/Bogota.rds") #Datos de manzanas Antioquia
sf_use_s2(FALSE)
mnzBogota<-subset(mnzB, select=c("MANZ_CCNCT", "geometry"))
Bog_buf <- st_buffer(Polchapinero,dist=0.001)
mnz_bog <- mnzMedellin[Bog_buf,]
## objeto osm para extracción de amenity Transporte público
osmbog = opq(bbox = getbb("Bogotá")) %>%
add_osm_feature(key="amenity" , value="bus_station")
class(osmbog)
osmbog_sf = osmbog %>% osmdata_sf()
View(osmbog_sf)
Transporte_publicoBog = osmbog_sf$osm_points %>% select(osm_id,amenity)
class(Transporte_publicoBog)
View(Transporte_publicoBog)
leaflet() %>% addTiles() %>% addCircleMarkers(data=Transporte_publicoBog , col="green")%>% addPolygons(data = Poblado, color = "black")
#Extracción Datos Bares
barbog = opq(bbox = st_bbox(mnz_bog)) %>%
add_osm_feature(key = "amenity", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
#Extracción Datos Bares
barbog = opq(bbox = st_bbox(mnzBogota)) %>%
add_osm_feature(key = "amenity", value = "bar") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="green") %>%  # transportepub
addCircles(data= HOSUEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="green") %>%  # transportepub
addCircles(data= HOSUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_pob) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="green") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="black" , weight=2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_bog) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="green") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="black" , weight=2)
#Parques
parkbog = opq(bbox = st_bbox(mnzBogota)) %>%
add_osm_feature(key = "leisure", value = "park") %>%
osmdata_sf() %>% .$osm_points %>% select(osm_id,name)
parkmed %>% head()
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_bog, color ="pink" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="black" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
leaflet() %>% addTiles() %>%
addPolygons(data=mnz_bog, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
addPolygons(data=mnzBogota, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
leaflet() %>% addTiles() %>%
addPolygons(data = Polchapinero, color = "darkblue")
addPolygons(data=mnzBogota, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
addPolygons(data=mnzBogota, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
#Mapa Oficial Chapinero
leaflet() %>% addTiles() %>%
addPolygons(data = PolPoblado_buf, color = "darkblue")%>%
addPolygons(data=mnzBogota, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
mnz_bog <- mnzBogota[Bog_buf,]
Bog_buf <- st_buffer(Polchapinero,dist=0.001)
## objeto osm para extracción de amenity Transporte público
osmbog = opq(bbox = getbb("Bogotá")) %>%
add_osm_feature(key="amenity" , value="bus_station")
osmbog_sf = osmbog %>% osmdata_sf()
#Mapa Oficial Chapinero
leaflet() %>% addTiles() %>%
addPolygons(data = Bog_buf, color = "darkblue")%>%
addPolygons(data=mnzBogota, color ="black" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
#Mapa Oficial Chapinero
leaflet() %>% addTiles() %>%
addPolygons(data = Bog_buf, color = "darkblue")%>%# Manzanas
addPolygons(data=Polchapinero, color ="grey" ) %>% # manzanas
addCircles(data= Transporte_publicoBog , col="purple") %>%  # transportepub
addCircles(data= HOUSEBOG , col="red", weight=2) %>% # apartamentos
addCircles(data=barbog , col="orange" , weight=2) %>%
addCircles(data = parkbog, col= "green", weight = 2)
leaflet() %>% addTiles() %>%
addPolygons(data = Poblado_buf, color = "darkblue")%>% #Polígono Poblado
addPolygons(data= Poblado, color ="#pink" ) %>% # Manzanas Poblado
addCircles(data= Transporte_publicoMed , col="purple") %>%  # Transporte Público Poblado
addCircles(data= HOUSEMED , col="red", weight=2) %>% # Apartamentos Poblado
addCircles(data=barant , col="black" , weight=2) %>% #Bares Poblado
addCircles(data = parkmed, col= "green", weight = 2) #Parques Poblado
DTEST<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
table(DTEST$l3)
DTRAIN<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTESTHOUSE.rds")
table(DTRAIN$l3)
table(DTRAIN$l3)
rm(DTEST)
rm(DTRAIN)
DTRAIN
DTRAIN<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
DTEST<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTESTHOUSE.rds")
table(DTRAIN$l3)
table(DTEST$l3)
DTEST<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
table(DTEST$l3)
DTRAIN<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTESTHOUSE.rds")
table(DTRAIN$l3)
table(DTRAIN$l3)
rm(DTRAIN)
rm(DTEST)
DTEST<- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
rm(DTRAIN)
rm(DTEST)
setwd("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Script")
DTESTHOUSE <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTESTHOUSE.rds")
TABLE(DTESTHOUSE$l3)
#La base de datos de entrenamiento cuenta con 13693
rm(DTESTHOUSE)
DTRAINHOUSE <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
#La base de datos de entrenamiento cuenta con 13693 observaciones.
#La base de datos de testeo cuenta con 11150 observaciones
rm(DTRAINHOUSE)
###Base de datos Problem set 3
library(readr)
#Se debe poner el directorio de donde está el script:
#Session-> Set Working directory -> To source file location, para lo cual se debe descargar el repositorio DTEST<-data.frame(readRDS("../Elementos_Guardados/test.rds" #Guardar las bases de datos
DTEST<-data.frame(readRDS("../Elementos_Guardados/test.rds"))  #Guardar las bases de datos
DTRAIN <- data.frame(readRDS("../Elementos_Guardados/train.rds"))
#Se ponen en minúscula los caracteres de description y title en la base train
DTRAIN$description<-str_to_lower(string=DTRAIN$description)
DTRAIN$title<-str_to_lower(string=DTRAIN$title)
#Se ponen en minúscula los caracteres de description y title en la base test
DTEST$description<-str_to_lower(string=DTEST$description)
DTEST$title<-str_to_lower(string=DTEST$title)
# Se eliminan las tildes
DTRAIN$description <- iconv(DTRAIN$description, from = "UTF-8", to = "ASCII//TRANSLIT")
DTEST$description <- iconv(DTEST$description, from = "UTF-8", to = "ASCII//TRANSLIT")
# Se eliminan caracteres especiales
DTRAIN$description <- str_replace_all(DTRAIN$description, "[^[:alnum:]]", " ")
DTEST$description <- str_replace_all(DTEST$description, "[^[:alnum:]]", " ")
# Se eliminan espacios extras
DTRAIN$description <- gsub("\\s+", " ", str_trim(DTRAIN$description))
DTEST$description <- gsub("\\s+", " ", str_trim(DTEST$description))
train<- DTRAIN %>% mutate(base = "train") #Se crea columna para identificar datos de train
test <- DTEST %>% mutate(base="test") #Se crea columna para identificar datos de test
HOUSE<- bind_rows(train,test) %>% st_as_sf(coords=c("lon","lat"),crs=4326)
readRDS("../Elementos_Guardados/HOUSEOF.rds")
HOUSEOF<-readRDS("../Elementos_Guardados/HOUSEOF.rds")
pat_1b <- "[:space:]+[:digit:]+[:space:]+baño" ## patrón para baños
pat_2b <- "[:space:]+[:digit:]+[:space:]+baños"
pat_3b<-"[:space:]+[:digit:]+baño"
pat_4b<-"[:space:]+[:digit:]+baños"
pat_5b <- "baño+[:space:]+[:digit:]"
pat_6b <- "baños+[:space:]+[:digit:]"
pat_7b <- "[:space:]+[:digit:]+[:space:]+banio"
pat_8b<-"[:space:]+[:digit:]+[:space:]+banios"
pat_9b <- "[:space:]+[:digit:]+banios"
pat_10b <- "banio+[:space:]+[:digit:]"
pat_11b <- "banios+[:space:]+[:digit:]"
pat_12b <- "[:space:]+[:digit:]+[:space:]+bano"
pat_13b <- "[:space:]+[:digit:]+[:space:]+banos"
pat_14b <- "[:space:]+[:digit:]+bano"
pat_15b <- "[:space:]+[:digit:]+banos"
pat_16b <- "bano+[:space:]+[:digit:]"
pat_17b <- "banos+[:space:]+[:digit:]"
pat_18b <- "[:space:]+[:digit:]+[:space:]+vano"
pat_19b <- "[:space:]+[:digit:]+[:space:]+vanos"
pat_20b <- "[:space:]+[:digit:]+vano"
pat_21b <- "[:space:]+[:digit:]+vanos"
pat_22b <- "vano+[:space:]+[:digit:]"
pat_23b <- "vanos+[:space:]+[:digit:]"
pat_24b <- "[:space:]+[:digit:]+[:space:]+vanio"
pat_25b <- "[:space:]+[:digit:]+[:space:]+vanios"
pat_26b <- "[:space:]+[:digit:]+vanio"
pat_27b<-"[:space:]+[:digit:]+vanios"
pat_28b <- "vanio+[:space:]+[:digit:]"
pat_29b <- "vanios+[:space:]+[:digit:]"
pat_30b <- "[:space:]+[:digit:]+[:space:]+vaño"
pat_31b <- "[:space:]+[:digit:]+[:space:]+vaños"
pat_32b <- "[:space:]+[:digit:]+vaño"
pat_33b<-"[:space:]+[:digit:]+vaños"
pat_34b <- "vaño+[:space:]+[:digit:]"
pat_35b <- "vaños+[:space:]+[:digit:]"
pat_36b <- "[:space:]+[:digit:]+[:space:]+bañio"
pat_37b <- "[:space:]+[:digit:]+[:space:]+bañios"
pat_38b <- "[:space:]+[:digit:]+bañio"
pat_39b<-"[:space:]+[:digit:]+bañios"
pat_40b <- "bañio+[:space:]+[:digit:]"
pat_41b <- "bañios+[:space:]+[:digit:]"
pat_42b <- "[:space:]+[:digit:]+[:space:]+bao"
pat_43b <- "[:space:]+[:digit:]+[:space:]+baos"
pat_44b <- "[:space:]+[:digit:]+bao"
pat_45b<-"[:space:]+[:digit:]+baos"
pat_46b <- "bao+[:space:]+[:digit:]"
pat_47b <- "baos+[:space:]+[:digit:]"
HOUSEOF <- HOUSEOF  %>%
mutate(banio_tot= str_extract(string=HOUSEOF$description , pattern= paste0(pat_1b,"|",pat_2b,"|", pat_3b,"|", pat_4b,"|", pat_5b,"|", pat_6b,"|", pat_7b,"|", pat_8b,"|", pat_9b,"|", pat_10b,"|", pat_11b,"|", pat_12b,"|", pat_13b,"|", pat_14b,"|", pat_15b,"|", pat_16b,"|", pat_17b,"|", pat_18b,"|", pat_19b,"|", pat_20b,"|", pat_21b,"|", pat_22b,"|", pat_23b,"|", pat_24b,"|", pat_25b,"|", pat_26b,"|", pat_27b,"|", pat_28b,"|", pat_29b,"|", pat_30b,"|", pat_31b,"|", pat_32b,"|", pat_33b,"|", pat_34b,"|", pat_35b,"|", pat_36b,"|", pat_37b,"|", pat_38b,"|", pat_39b,"|", pat_40b,"|", pat_41b,"|", pat_42b,"|", pat_43b,"|", pat_44b,"|", pat_45b,"|", pat_46b,"|", pat_47b) ))
View(HOUSEOF)
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "," , replacement = ".")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baño" , replacement = "")
TABLE(DTESTHOUSE$l3)
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baños" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaño" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaños" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bañio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bañios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bao" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "\n" , replacement = "")
HOUSEOF$banio_tot<-as.numeric(HOUSEOF$banio_tot)
View(HOUSEOF)
HOUSEOF$banio_tot[is.na(HOUSEOF$banio_tot)] = 1 #Se imputa el número 1, teniendo en cuenta que por nivel de sanidad, debe existir al menos 1 baño en las viviendas
summary(HOUSEOF$banio_tot)
HOUSEOF$bathrooms[is.na(HOUSEOF$bathrooms)] = 1
HOUSEOF[24795,]
in.na(HOUSEOF$bathrooms)
is.na(HOUSEOF$bathrooms)
table(is.na(HOUSEOF$bathrooms))
rm(list = ls()) #Limpia las variables que existan al momento de correr el código
HOUSEOF<-readRDS("../Elementos_Guardados/HOUSEOF.rds")
pat_1b <- "[:space:]+[:digit:]+[:space:]+baño" ## patrón para baños
pat_2b <- "[:space:]+[:digit:]+[:space:]+baños"
pat_3b<-"[:space:]+[:digit:]+baño"
pat_4b<-"[:space:]+[:digit:]+baños"
pat_5b <- "baño+[:space:]+[:digit:]"
pat_6b <- "baños+[:space:]+[:digit:]"
pat_7b <- "[:space:]+[:digit:]+[:space:]+banio"
pat_8b<-"[:space:]+[:digit:]+[:space:]+banios"
pat_9b <- "[:space:]+[:digit:]+banios"
pat_10b <- "banio+[:space:]+[:digit:]"
pat_11b <- "banios+[:space:]+[:digit:]"
pat_12b <- "[:space:]+[:digit:]+[:space:]+bano"
pat_13b <- "[:space:]+[:digit:]+[:space:]+banos"
pat_14b <- "[:space:]+[:digit:]+bano"
pat_15b <- "[:space:]+[:digit:]+banos"
pat_16b <- "bano+[:space:]+[:digit:]"
pat_17b <- "banos+[:space:]+[:digit:]"
pat_18b <- "[:space:]+[:digit:]+[:space:]+vano"
pat_19b <- "[:space:]+[:digit:]+[:space:]+vanos"
pat_20b <- "[:space:]+[:digit:]+vano"
pat_21b <- "[:space:]+[:digit:]+vanos"
pat_22b <- "vano+[:space:]+[:digit:]"
pat_23b <- "vanos+[:space:]+[:digit:]"
pat_24b <- "[:space:]+[:digit:]+[:space:]+vanio"
pat_25b <- "[:space:]+[:digit:]+[:space:]+vanios"
pat_26b <- "[:space:]+[:digit:]+vanio"
pat_27b<-"[:space:]+[:digit:]+vanios"
pat_28b <- "vanio+[:space:]+[:digit:]"
pat_29b <- "vanios+[:space:]+[:digit:]"
pat_30b <- "[:space:]+[:digit:]+[:space:]+vaño"
pat_31b <- "[:space:]+[:digit:]+[:space:]+vaños"
pat_32b <- "[:space:]+[:digit:]+vaño"
pat_33b<-"[:space:]+[:digit:]+vaños"
pat_34b <- "vaño+[:space:]+[:digit:]"
pat_35b <- "vaños+[:space:]+[:digit:]"
pat_36b <- "[:space:]+[:digit:]+[:space:]+bañio"
pat_37b <- "[:space:]+[:digit:]+[:space:]+bañios"
pat_38b <- "[:space:]+[:digit:]+bañio"
pat_39b<-"[:space:]+[:digit:]+bañios"
pat_40b <- "bañio+[:space:]+[:digit:]"
pat_41b <- "bañios+[:space:]+[:digit:]"
pat_42b <- "[:space:]+[:digit:]+[:space:]+bao"
pat_43b <- "[:space:]+[:digit:]+[:space:]+baos"
pat_44b <- "[:space:]+[:digit:]+bao"
pat_45b<-"[:space:]+[:digit:]+baos"
pat_46b <- "bao+[:space:]+[:digit:]"
pat_47b <- "baos+[:space:]+[:digit:]"
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "," , replacement = ".")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baño" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baños" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaño" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaños" , replacement = "")
HOUSEOF <- HOUSEOF  %>%
mutate(banio_tot= str_extract(string=HOUSEOF$description , pattern= paste0(pat_1b,"|",pat_2b,"|", pat_3b,"|", pat_4b,"|", pat_5b,"|", pat_6b,"|", pat_7b,"|", pat_8b,"|", pat_9b,"|", pat_10b,"|", pat_11b,"|", pat_12b,"|", pat_13b,"|", pat_14b,"|", pat_15b,"|", pat_16b,"|", pat_17b,"|", pat_18b,"|", pat_19b,"|", pat_20b,"|", pat_21b,"|", pat_22b,"|", pat_23b,"|", pat_24b,"|", pat_25b,"|", pat_26b,"|", pat_27b,"|", pat_28b,"|", pat_29b,"|", pat_30b,"|", pat_31b,"|", pat_32b,"|", pat_33b,"|", pat_34b,"|", pat_35b,"|", pat_36b,"|", pat_37b,"|", pat_38b,"|", pat_39b,"|", pat_40b,"|", pat_41b,"|", pat_42b,"|", pat_43b,"|", pat_44b,"|", pat_45b,"|", pat_46b,"|", pat_47b) ))
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "," , replacement = ".")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baño" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baños" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "banos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vano" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vanios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaño" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "vaños" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bañio" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bañios" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "bao" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "baos" , replacement = "")
HOUSEOF$banio_tot<-str_replace_all(string = HOUSEOF$banio_tot, pattern = "\n" , replacement = "")
HOUSEOF$banio_tot<-as.numeric(HOUSEOF$banio_tot)
HOUSEOF$banio_tot[is.na(HOUSEOF$banio_tot)] = 1 #Se imputa el número 1, teniendo en cuenta que por nivel de sanidad, debe existir al menos 1 baño en las viviendas
summary(HOUSEOF$banio_tot)
filtro2<-is.na(HOUSEOF$bathrooms)
HOUSEOF$bathrooms[filtro2]<-HOUSEOF$banio_tot
summary(HOUSEOF$bathrooms)
View(HOUSEOF)
table(is.na(HOUSEOF$bathrooms))
#Descripción baños
baños<- as.numeric(HOUSEOF$bathrooms)
class(baños)
plot(hist(baños),col = "red", main="Histograma No. de baños de la vivienda",
xlab="Habitaciones",
ylab="Frecuencia")
summary(baños)
modebaños<- function(baños){
return(as.numeric(names(which.max(table(baños)))))}
modebaños(baños)
#Para guardar la base de datos
saveRDS(HOUSEOF, "../Elementos_Guardados/HOUSEOF.rds" )
HOUSEOF2 <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/HOUSEOF.rds")
HOUSEM<-subset(HOUSEOF, select=c("property_id", "l3", "property_type", "price", "surface_new_3", "MANZ_CCNCT", "geometry", "parqueaderoT", "ascensorT", "bathrooms", "habitaciones", "base", "min_dist_bar_", "min_dist_transp_", "min_dist_park"))
#La base de datos oficial de trabajo es HOUSEM, en donde existen 24843 observaciones (Base de entrenamiento y base de testeo)
#Para guardar la base de datos
saveRDS(HOUSEM, "../Elementos_Guardados/HOUSEM.rds" )
HOUSEM2 <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/HOUSEM.rds")
View(HOUSEM2)
DTRAINHOUSE<- HOUSEM[HOUSEM$base=="train",]
DTESTHOUSE<- HOUSEM[HOUSEM$base=="test",]
saveRDS(DTRAINHOUSE, "../Elementos_Guardados/DTRAINHOUSE.rds" )
saveRDS(DTESTHOUSE, "../Elementos_Guardados/DTESTHOUSE.rds" )
DTESTHOUSE2 <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTESTHOUSE.rds")
View(DTESTHOUSE2)
DTRAINHOUSE2 <- readRDS("C:/Users/valer/Desktop/Andes/Intersemestral/Big Data/ArchivoPS3/Problem-Set-3/Elementos_Guardados/DTRAINHOUSE.rds")
gc()
